#! RHF Linear Exchange Algorithm test for water


molecule mol {
    0 1
    O
    H 1 0.96
    H 1 0.96 2 104.5
    symmetry c1
    no_reorient
    no_com
}

set {
    scf_type dfdirj+snlink 
    df_scf_guess false
    basis 6-31g(d) 
    e_convergence 1.0e-10
    screening schwarz
    incfock true 
    incfock_full_fock_every 4
    ints_tolerance 1.0e-12
    linK_ints_tolerance 1.0e-12
    #print 7
    #debug 7
    #maxiter 2
}

linK_energy = energy('b3lyp')
psi4.compare_values(ref_energy, linK_energy, 9, "HF Energy (Using LinK algo)")
compare(1, variable("SCF ITERATIONS") < 12.0, "LinK Incfock Efficient")
