#! RHF Linear Exchange Algorithm test for water


molecule mol {
    0 1
    O
    H 1 0.96
    H 1 0.96 2 104.5
    symmetry c1
    no_reorient
    no_com
}

set {
    scf_type dfdirj+snlink 
    guess sad 
    df_scf_guess false
    basis 6-311g(d) 
    e_convergence 1.0e-10
    screening schwarz
    incfock true 
    incfock_full_fock_every 4
    ints_tolerance 1.0e-12
    linK_ints_tolerance 1.0e-12
    snlinK_ints_tolerance 1.0e-12
    snlink_use_gpu false 
    snlink_force_cartesian false
    #maxiter 3
    print 7
    debug 7
    snlink_radial_points 70
    snlink_spherical_points 302
    cosx_radial_points_initial 70
    cosx_spherical_points_initial 302
    cosx_radial_points_final 70
    cosx_spherical_points_final 302
    snlink_force_cartesian false 
}

linK_energy = energy('scf')
psi4.compare_values(ref_energy, linK_energy, 9, "HF Energy (Using LinK algo)")
compare(1, variable("SCF ITERATIONS") < 12.0, "LinK Incfock Efficient")
