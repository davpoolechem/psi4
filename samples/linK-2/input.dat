#! RKS Linear Exchange Algorithm test for benzene

molecule mol {
  0 1
  H   1.0131690738465817   -1.5835021154162925   -1.7978401310386911
  H   -1.0131690738465817   1.5835021154162925   -5.012160365319985
  H   -1.8164621323959855   -0.7357020536229176   -4.931121359413318
  H   1.8164621323959855   0.7357020536229176   -1.8788791369453572
  H   -0.7729940563410085   -2.3568841717855844   -3.3212372420741265
  H   0.7729940563410085   2.3568841717855844   -3.4887632542845504
  C   0.5690300414747392   -0.9024360657756142   -2.502675182411813
  C   -0.5690300414747392   0.9024360657756142   -4.307325313946864
  C   -1.0176030741697608   -0.4210740306907108   -4.263060310720532
  C   1.0176030741697608   0.4210740306907108   -2.546940185638147
  C   -0.44857303269502175   -1.3122060956424129   -3.358011244754464
  C   0.44857303269502175   1.3122060956424129   -3.4519892516042137
  symmetry c1
  no_reorient
  no_com
}

set {
    scf_type dfdirj+snlink
    snlink_radial_points 35 
    snlink_spherical_points 110 
    guess sad 
    df_scf_guess false
    basis 6-311g(2df, p) 
    e_convergence 1.0e-10
    screening schwarz 
    incfock true 
}

linK_energy = energy('scf')
psi4.compare_values(ref_energy, linK_energy, 8, "B3LYP Energy (using LinK algo)")
compare(1, variable("SCF ITERATIONS") < 13.0, "LinK Incfock Efficient")
