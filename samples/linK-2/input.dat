#! RKS Linear Exchange Algorithm test for benzene


molecule mol {
    0 1
    C    -6.0478252   -1.4216736    0.0000000
    C    -6.4545034   -0.8554459    1.2062048
    C    -6.4545034   -0.8554459   -1.2062048
    C    -7.2667970    0.2771610    1.2069539
    C    -7.6714781    0.8450211    0.0000000
    C    -7.2667970    0.2771610   -1.2069539
    H    -6.1338534   -1.2920593   -2.1423150
    H    -7.5824943    0.7163066   -2.1437977
    H    -8.3030422    1.7232700    0.0000000
    H    -7.5824943    0.7163066    2.1437977
    H    -6.1338534   -1.2920593    2.1423150
    H    -5.4060253   -2.2919049    0.0000000
    C    -1.0478252   -1.4216736    0.0000000
    C    -1.4545034   -0.8554459    1.2062048
    C    -1.4545034   -0.8554459   -1.2062048
    C    -2.2667970    0.2771610    1.2069539
    C    -2.6714781    0.8450211    0.0000000
    C    -2.2667970    0.2771610   -1.2069539
    H    -1.1338534   -1.2920593   -2.1423150
    H    -2.5824943    0.7163066   -2.1437977
    H    -3.3030422    1.7232700    0.0000000
    H    -2.5824943    0.7163066    2.1437977
    H    -1.1338534   -1.2920593    2.1423150
    H    -0.4060253   -2.2919049    0.0000000
    symmetry c1
    no_reorient
    no_com
}

set {
    scf_type dfdirj+snlink
    guess sad 
    df_scf_guess false
    #basis jun-cc-pVTZ 
    basis 6-311++g(3df, 2pd) 
    e_convergence 1.0e-10
    screening schwarz
    incfock false 
    ints_tolerance 1.0e-12
    snlink_ints_tolerance 1.0e-12
    snlink_pruning_scheme robust 
    dft_radial_scheme em 
    snlink_radial_points  35 
    snlink_spherical_points 110
    snlink_use_gpu false 
    #print 7
    #debug 7
    #maxiter 3
}

linK_energy = energy('b3lyp')
psi4.compare_values(ref_energy, linK_energy, 8, "B3LYP Energy (using LinK algo)")
compare(1, variable("SCF ITERATIONS") < 13.0, "LinK Incfock Efficient")
