#! RKS Linear Exchange Algorithm test for benzene


molecule mol {
    0 1
    C  0.692768, -1.776560, 0.001402
    C  3.351080, -1.776680, 0.002211
    C  4.680350, 0.525219, 0.001225
    C  3.351210, 2.827440, -0.000703
    C  0.693087, 2.827560, -0.001559
    C -0.636278, 0.525491, -0.000469
    H -0.341271, -3.567590, 0.002213
    H  4.384920, -3.567830, 0.003736
    H  6.748440, 0.525274, 0.001880
    H  4.385510, 4.618320, -0.001487
    H -0.341001, 4.618570, -0.003056
    H -2.704370, 0.525727, -0.001098
    unit bohr
    symmetry c1
    no_reorient
    no_com
}

set {
    scf_type dfdirj+snlink
    snlink_radial_points 35 
    snlink_spherical_points 110 
    guess sad 
    df_scf_guess false
    basis bse:aug-cc-pVDZ 
    e_convergence 1.0e-10
    screening schwarz 
    incfock true 
}

linK_energy = energy('scf')
psi4.compare_values(ref_energy, linK_energy, 8, "B3LYP Energy (using LinK algo)")
compare(1, variable("SCF ITERATIONS") < 13.0, "LinK Incfock Efficient")
